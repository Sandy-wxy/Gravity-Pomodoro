<view class="container">
  <view class="header">
    <view class="year-month">
      <text class="year">{{year}}年</text>
      <text class="month">{{month}}月</text>
    </view>
    <view class="controls">
      <view class="btn" bindtap="prevMonth">◀</view>
      <view class="btn" bindtap="nextMonth">▶</view>
    </view>
  </view>

  <view class="week-row">
    <view class="week-item" wx:for="{{['日','一','二','三','四','五','六']}}" wx:key="*this">{{item}}</view>
  </view>

  <view class="calendar-grid">
    <view 
      class="day-cell {{item.type}} {{item.day === selectedDay && item.type !== 'empty' ? 'selected' : ''}} {{item.isToday ? 'today' : ''}}" 
      wx:for="{{calendarDays}}" 
      wx:key="fullDate"
      bindtap="onDayClick"
      data-day="{{item.day}}"
      data-type="{{item.type}}">
      
      <text class="num">{{item.day > 0 ? item.day : ''}}</text>
      
      <view class="dot" wx:if="{{item.hasData}}"></view>
    </view>
  </view>

  <view class="data-panel">
    <view class="panel-title">
      <text>{{month}}月{{selectedDay}}日 档案</text>
    </view>
    
    <view class="stats-row">
      <view class="stat-box">
        <text class="val">{{dailyStats.totalTasks}}</text>
        <text class="label">任务数</text>
      </view>
      <view class="stat-box">
        <text class="val highlight">{{dailyStats.flowCount}}</text>
        <text class="label">心流项</text>
      </view>
      <view class="stat-box">
        <text class="val">{{dailyStats.totalDuration}}</text>
        <text class="label">预计分钟</text>
      </view>
    </view>

    <scroll-view scroll-y class="log-list" wx:if="{{dailyStats.logs.length > 0}}">
      <view class="log-item" wx:for="{{dailyStats.logs}}" wx:key="_id">
        <view class="status-dot {{item.result === '完成' ? 'green' : 'gray'}}"></view>
        <view class="log-content">
          <text class="log-name">{{item.taskName}}</text>
          <text class="log-time">{{item.timeStr}}</text>
        </view>
        <text class="log-res">{{item.result}}</text>
      </view>
    </scroll-view>
    
    <view class="empty-tip" wx:else>
      该日暂无作战记录
    </view>
  </view>
</view>